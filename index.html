<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0,shrink-to-fit=no, viewport-fit=cover">
    <meta name="keywords" content="蓝桥到家">
    <meta name="description" itemprop="description" content="生鲜副食、饮品乳品、鲜花蛋糕">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>首页</title>
    <link rel="stylesheet" type="text/css" href="styles/reset.css" />
    <link rel="stylesheet" type="text/css" href="styles/iconfont/iconfont.css" />
    <link rel="stylesheet" type="text/css" href="styles/index.css" />
    <link rel="stylesheet" type="text/css" href="styles/common.css" />
    <script type="text/javascript" src="js/common.js"></script>
</head>

<body>
<div class="wrap">
    <div class="container">
        <!-- 头部 start -->
        <header class="header">
            <div class="address">
                <i class="iconfont icon-dizhi"></i>
                <p>东方广场</p>
            </div>
            <input type="text" placeholder="满99减98">
            <div class="search-words">
                <a href="#" class="search-word-item">牛奶</a>
                <a href="#" class="search-word-item">黄瓜</a>
                <a href="#" class="search-word-item">方便面</a>
                <a href="#" class="search-word-item">面包</a>
                <a href="#" class="search-word-item">鸡蛋</a>
                <a href="#" class="search-word-item">矿泉水</a>
                <a href="#" class="search-word-item">酸奶</a>
            </div>
        </header>
        <!-- 头部 end -->
        <!-- 分类导航 start -->
        <nav class="menu_category">
            <ul>
                <li>
                    <a href="#">
                        <img src="images/scroll/scroll01.png" alt="">
                        <p>超市</p>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <img src="images/scroll/scroll02.png" alt="">
                        <p>生鲜果蔬</p>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <img src="images/scroll/scroll03.png" alt="">
                        <p>蛋糕甜品</p>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <img src="images/scroll/scroll04.png" alt="">
                        <p>鲜花</p>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <img src="images/scroll/scroll05.png" alt="">
                        <p>送药上门</p>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <img src="images/scroll/scroll10.png" alt="">
                        <p>手机家电</p>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <img src="images/scroll/scroll06.png" alt="">
                        <p>个洗家清</p>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <img src="images/scroll/scroll07.png" alt="">
                        <p>VIP 特价</p>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <img src="images/scroll/scroll09.png" alt="">
                        <p>储值特惠</p>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <img src="images/scroll/scroll08.png" alt="">
                        <p>帮助中心</p>
                    </a>
                </li>
            </ul>
        </nav>
        <!-- 分类导航 end -->
        <!-- banner start -->
        <img src="images/banner/02.jpg" style="width: 100%;">
        <!-- banner end -->
        <!-- 附近商家 start -->
        <div class="shop">
            <nav class="title">
                <h2>附近商家 <a href="pages/shop-list.html">查看更多</a> </h2>
            </nav>
            <div class="shop_list">
                <ul id="shopContainer">
                    <!-- 商家信息将通过JS动态加载 -->
                </ul>
            </div>
        </div>
        <!-- 附近商家 end -->
    </div>
    <!-- 底部 start -->
    <footer class="footer">
        <ul>
            <li>
                <a href="index.html" class="tabcur">
                    <span class="iconfont icon-shouye"></span> 首页
                </a>
            </li>
            <li>
                <a href="pages/shopcart.html">
                    <span class="iconfont icon-gouwuche"></span> 购物车
                </a>
            </li>
            <li>
                <a href="pages/order.html">
                    <span class="iconfont icon-dingdan"></span> 订单
                </a>
            </li>
            <li>
                <a href="pages/user.html">
                    <span class="iconfont icon-wode"></span> 我的
                </a>
            </li>
        </ul>
    </footer>
    <!-- 底部 end -->
</div>

<!-- 在 </body> 标签前添加以下脚本 -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // 接口地址改为 json-server 实际提供的 /shop_list
        fetch('http://localhost:3000/shop_list')
            .then(response => {
                if (!response.ok) {
                    throw new Error('接口请求失败');
                }
                return response.json();
            })
            .then(shops => {
                // 获取商家列表的 UL 容器（原页面中是 shop_list 下的 ul）
                const shopListUl = document.querySelector('.shop_list ul');
                // 清空静态内容
                shopListUl.innerHTML = '';

                // 遍历接口返回的商家数据，动态生成 HTML
                shops.forEach(shop => {
                    // 生成活动信息（如“特价”“满减”等）
                    let activitiesHtml = '';
                    shop.activities.forEach(activity => {
                        activitiesHtml += `
            <div class="main_price">
              <span class="act_icon">${activity.type}</span>
              <span class="act_desc">${activity.desc}</span>
            </div>
          `;
                    });

                    // 生成单个商家的 HTML
                    const shopHtml = `
          <li>
            <a href="pages/shop.html?id=${shop.id}">
              <div class="shop_info">
                <img src="${shop.imgUrl}" class="shop_img">
                <div class="shop_main">
                  <div class="main_top">
                    <h3>${shop.name}</h3>
                  </div>
                  <div class="main_more">
                    <div class="main_desc">
                      <img src="images/shop/star.png" alt="">
                      <span class="sale">月销${shop.monthSales}+</span>
                    </div>
                    <div class="money_limit">
                      <span>${shop.minOrderAmount}起送 | 配送费${shop.deliveryFee}</span>
                      <span>${shop.distance} | ${shop.deliveryTime}</span>
                    </div>
                    ${activitiesHtml}
                  </div>
                </div>
              </div>
            </a>
          </li>
        `;

                    // 添加到列表中
                    shopListUl.innerHTML += shopHtml;
                });
            })
            .catch(error => {
                console.error('加载商家数据失败:', error);
                // 若失败，保留原静态内容（无需额外修改）
            });
    });
</script>
</body>

</html>